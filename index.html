<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æˆ‘çš„èµ›åšå†’é™©</title>
    <style>
        /* --- ç®€å•çš„ CSS æ ·å¼ï¼Œè´Ÿè´£å¥½ä¸å¥½çœ‹ --- */
        body {
            background-color: #0d0d0d;
            color: #00ff41; /* èµ›åšç»¿ */
            font-family: 'Courier New', Courier, monospace;
            margin: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
        }
        .game-container {
            width: 100%;
            max-width: 600px;
            background: #1a1a1a;
            border: 2px solid #00ff41;
            padding: 20px;
            box-shadow: 0 0 20px rgba(0, 255, 65, 0.2);
        }
        .status-bar {
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
            border-bottom: 1px solid #333;
            padding-bottom: 10px;
        }
        .scene-image {
            width: 100%;
            height: 250px;
            background-color: #333;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 20px;
            color: #555;
            border: 1px dashed #555;
        }
        /* å¦‚æœä½ æœ‰çœŸçš„å›¾ç‰‡ï¼Œè¿™ä¸ªæ ·å¼ä¼šè®©å›¾ç‰‡é€‚åº”å±å¹• */
        .scene-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        .story-text {
            font-size: 16px;
            line-height: 1.6;
            margin-bottom: 30px;
            min-height: 80px;
        }
        .btn-group {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        button {
            background: transparent;
            border: 1px solid #00ff41;
            color: #00ff41;
            padding: 15px;
            font-size: 16px;
            cursor: pointer;
            text-align: left;
            transition: all 0.2s;
        }
        button:hover {
            background: #00ff41;
            color: #000;
        }
        button:disabled {
            border-color: #555;
            color: #555;
            cursor: not-allowed;
        }
    </style>
</head>
<body>

<div class="game-container">
    <div class="status-bar">
        <span id="stat-hp">â¤ï¸ ç”Ÿå‘½: 100</span>
        <span id="stat-san">ğŸ§  ç²¾ç¥: 100</span>
    </div>

    <div class="scene-image" id="scene-img">
        [ å›¾ç‰‡åŒºåŸŸ ]
    </div>

    <div class="story-text" id="story-text">
        å‰§æƒ…åŠ è½½ä¸­...
    </div>

    <div class="btn-group" id="choices-area">
        </div>
</div>

<script>
    /* --- æ¸¸æˆæ•°æ®åŒº (Bro, ä½ ä¸»è¦æ”¹è¿™é‡Œ!) --- */
    
    // ç©å®¶åˆå§‹çŠ¶æ€
    let playerState = {
        hp: 100,
        san: 100
    };

    // å‰§æœ¬é…ç½® (JSONæ ¼å¼)
    const storyNodes = {
        "start": {
            "text": "ä½ é†’æ¥æ—¶ï¼Œå‘¨å›´æ˜¯ä¸€ç‰‡åºŸå¢Ÿã€‚ç©ºæ°”ä¸­å¼¥æ¼«ç€é…¸é›¨çš„å‘³é“ã€‚ä½ çš„å¤´å¾ˆç—›ï¼Œå£è¢‹é‡Œåªå‰©ä¸‹ä¸€å—å‹ç¼©é¥¼å¹²ã€‚",
            "image": "https://placehold.co/600x400/1a1a1a/00ff41?text=Ruins", // è¿™é‡Œçš„é“¾æ¥ä»¥åæ¢æˆä½ è‡ªå·±çš„å›¾ç‰‡æ–‡ä»¶
            "choices": [
                { 
                    "text": "åƒæ‰é¥¼å¹²ï¼Œè¡¥å……ä½“åŠ›", 
                    "effect": { "hp": 10, "san": 5 },
                    "nextNode": "eat_cookie" 
                },
                { 
                    "text": "ç•™ç€é¥¼å¹²ï¼Œå…ˆè§‚å¯Ÿå››å‘¨", 
                    "effect": { "san": -5 },
                    "nextNode": "look_around" 
                }
            ]
        },
        "eat_cookie": {
            "text": "é¥¼å¹²å¹²æ¶©éš¾å’½ï¼Œä½†ä½ æ„Ÿè§‰åˆ°ä½“åŠ›æ¢å¤äº†ä¸€äº›ã€‚ä½ å†³å®šç»§ç»­å‰è¿›ï¼Œå‰æ–¹æœ‰ä¸¤æ¡è·¯ã€‚",
            "image": "https://placehold.co/600x400/1a1a1a/00ff41?text=Cookie",
            "choices": [
                { 
                    "text": "èµ°å‘å‘å…‰çš„åŸå¸‚åºŸå¢Ÿ", 
                    "nextNode": "city_ruins" 
                },
                { 
                    "text": "èµ°è¿›é»‘æš—çš„æ£®æ—", 
                    "nextNode": "dark_forest" 
                }
            ]
        },
        "look_around": {
            "text": "ä½ å¿ç€é¥¥é¥¿è§‚å¯Ÿå››å‘¨ã€‚çªç„¶ï¼ŒåºŸå¢Ÿåé¢ä¼ æ¥ä¸€å£°ä½å¼ï¼Œä¸€åªæœºæ¢°é‡ç‹—æ­£åœ¨ç›¯ç€ä½ ï¼",
            "image": "https://placehold.co/600x400/1a1a1a/00ff41?text=Danger",
            "choices": [
                { 
                    "text": "é€ƒè·‘ï¼", 
                    "effect": { "hp": -20, "san": -10 },
                    "nextNode": "run_away" 
                },
                { 
                    "text": "æ¡èµ·çŸ³å¤´æˆ˜æ–—", 
                    "effect": { "hp": -50 },
                    "nextNode": "fight" 
                }
            ]
        },
        // --- ç»“å±€èŠ‚ç‚¹ ---
        "city_ruins": {
            "text": "ã€ç»“å±€ã€‘ä½ èµ°è¿›äº†åŸå¸‚åºŸå¢Ÿï¼Œå‘ç°è¿™é‡Œå…¶å®æ˜¯èµ›åšå¾’æ­¥çš„ç»ˆç‚¹ã€‚ä½ æ´»ä¸‹æ¥äº†ã€‚",
            "image": "https://placehold.co/600x400/1a1a1a/00ff41?text=Victory",
            "choices": [
                { "text": "é‡æ–°å¼€å§‹", "nextNode": "start", "reset": true }
            ]
        },
        "dark_forest": {
            "text": "ã€ç»“å±€ã€‘æ£®æ—é‡Œå……æ»¡äº†è¾å°„ï¼Œä½ å€’åœ¨äº†åŠè·¯ä¸Š...",
            "image": "https://placehold.co/600x400/1a1a1a/00ff41?text=Game+Over",
            "choices": [
                { "text": "é‡æ–°å¼€å§‹", "nextNode": "start", "reset": true }
            ]
        },
        "run_away": {
            "text": "ã€ç»“å±€ã€‘ä½ æ…Œä¸æ‹©è·¯ï¼Œæ‘”ä¸‹äº†æ‚¬å´–...",
            "image": "https://placehold.co/600x400/1a1a1a/00ff41?text=Game+Over",
            "choices": [
                { "text": "é‡æ–°å¼€å§‹", "nextNode": "start", "reset": true }
            ]
        },
        "fight": {
            "text": "ã€ç»“å±€ã€‘è™½ç„¶ä½ å‡»é€€äº†é‡ç‹—ï¼Œä½†ä¼¤åŠ¿è¿‡é‡ï¼Œæ— æ³•ç»§ç»­å‰è¡Œã€‚",
            "image": "https://placehold.co/600x400/1a1a1a/00ff41?text=Game+Over",
            "choices": [
                { "text": "é‡æ–°å¼€å§‹", "nextNode": "start", "reset": true }
            ]
        }
    };

    /* --- æ¸¸æˆé€»è¾‘åŒº (Bro, è¿™éƒ¨åˆ†ä¸ç”¨åŠ¨) --- */
    function renderNode(nodeId) {
        const node = storyNodes[nodeId];
        if (!node) {
            console.error("æ‰¾ä¸åˆ°èŠ‚ç‚¹:", nodeId);
            return;
        }

        // æ›´æ–°æ–‡æœ¬
        document.getElementById("story-text").innerText = node.text;

        // æ›´æ–°å›¾ç‰‡ (å¦‚æœæœ‰)
        const imgDiv = document.getElementById("scene-img");
        if (node.image) {
            imgDiv.innerHTML = `<img src="${node.image}" alt="scene">`;
        } else {
            imgDiv.innerHTML = `[ æš‚æ— å›¾ç‰‡ ]`;
        }

        // æ›´æ–°æŒ‰é’®
        const choicesArea = document.getElementById("choices-area");
        choicesArea.innerHTML = ""; // æ¸…ç©ºæ—§æŒ‰é’®

        node.choices.forEach(choice => {
            const btn = document.createElement("button");
            // æ˜¾ç¤ºä»£ä»·æç¤º
            let costText = "";
            if (choice.effect) {
                if (choice.effect.hp) costText += ` (ç”Ÿå‘½ ${choice.effect.hp > 0 ? '+' : ''}${choice.effect.hp})`;
                if (choice.effect.san) costText += ` (ç²¾ç¥ ${choice.effect.san > 0 ? '+' : ''}${choice.effect.san})`;
            }
            btn.innerText = choice.text + costText;
            
            btn.onclick = () => {
                // 1. ç»“ç®—æ•°å€¼
                if (choice.effect) {
                    if (choice.effect.hp) playerState.hp += choice.effect.hp;
                    if (choice.effect.san) playerState.san += choice.effect.san;
                }
                
                // é™åˆ¶æ•°å€¼èŒƒå›´
                if (playerState.hp > 100) playerState.hp = 100;
                if (playerState.san > 100) playerState.san = 100;

                updateStatus();

                // 2. æ£€æŸ¥æ­»äº¡
                if (playerState.hp <= 0) {
                    alert("ä½ å› ä¸ºç”Ÿå‘½è€—å°½è€Œå€’ä¸‹äº†...");
                    location.reload();
                    return;
                }

                // 3. æ£€æŸ¥é‡ç½®
                if (choice.reset) {
                    playerState.hp = 100;
                    playerState.san = 100;
                    updateStatus();
                }

                // 4. è·³è½¬
                renderNode(choice.nextNode);
            };
            choicesArea.appendChild(btn);
        });
    }

    function updateStatus() {
        document.getElementById("stat-hp").innerText = `â¤ï¸ ç”Ÿå‘½: ${playerState.hp}`;
        document.getElementById("stat-san").innerText = `ğŸ§  ç²¾ç¥: ${playerState.san}`;
    }

    // æ¸¸æˆå¼€å§‹
    updateStatus();
    renderNode("start");

</script>
</body>
</html>